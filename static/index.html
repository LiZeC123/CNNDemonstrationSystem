<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title></title>
    <style type="text/css">
        .showCanvas {
            height: 1344px;
            background-color: #7c7c7c;
            position: relative;
        }

        #mainCanvas {
            width: 356px;
            height: 1344px;

            background-color: #7c7c7c;
            position: relative;
            top: 0;
        }

        .line {
            position: relative;
            width: 50px;
            height: 1344px;
            background-color: #535353;
        }
    </style>
    <script src="js/jquery-1.7.2.min.js"></script>
    <script src="js/paper-full.min.js"></script>
    <script src="js/dataTools.js"></script>
    <script src="js/paper/mouseBrush.js" type="text/paperscript" canvas="drawCanvas"></script>
    <script src="js/paper/mainMain.js" type="text/paperscript" canvas="mainCanvas"></script>
    <script src="js/paper/mainConv1.js" type="text/paperscript" canvas="conv1Canvas"></script>
    <script src="js/paper/mainConv2.js" type="text/paperscript" canvas="conv2Canvas"></script>
    <script type="text/javascript">
        //转canvas保存为base64 dataURL
        function copyImage() {
            const canvas = document.getElementById('drawCanvas');
            const img_png_src = canvas.toDataURL('image/png');
            //document.getElementById('image_png').src = img_png_src;
            $.post('http://127.0.0.1:5000/upload', {"image": img_png_src}, function (jsonStr) {
                const result = JSON.parse(jsonStr);
                console.log(result);

                $.post('http://127.0.0.1:5000/inputImage', function (jsonStr) {
                    window.inputImage = JSON.parse(jsonStr);
                    window.mainMainUpdate();
                });

                $.post('http://127.0.0.1:5000/conv1', function (jsonStr) {
                    window.conv1 = JSON.parse(jsonStr);
                    window.mainConv1Update();
                });

                $.post('http://127.0.0.1:5000/conv2', function (jsonStr) {
                    window.conv2 = JSON.parse(jsonStr);
                    window.mainConv2Update();
                });

                $.post("http://127.0.0.1:5000/fc1", function (jsonStr) {
                    console.log(JSON.parse(jsonStr))
                });

                $.post("http://127.0.0.1:5000/fc2", function (jsonStr) {
                    console.log(JSON.parse(jsonStr))
                });

                $.post("http://127.0.0.1:5000/prediction", function (jsonStr) {
                    var result = JSON.parse(jsonStr);
                    $("#numberResult").html(result.prediction[0])
                });
            })
        }

        $(function () {
            $("#conv1Canvas").click(function () {
                $("html").scrollTop(500);
                $("#line1").hide("slow");
                $("#line2").hide("slow");
                $("#line3").hide("slow");
                $("#conv2Canvas").hide("slow", function () {
                    window.location.href = "/static/Conv1.html";
                });
            });

        })
    </script>
</head>

<body>
<canvas id="drawCanvas" width="112" height="112" style="background-color: #7c7c7c"></canvas>
<div style="position: absolute;top: 8px;left: 122px">
    <button id="btnExport" style="width:80px;background-color:pink; " onclick="copyImage(); ">导出</button>
    <br/>
    <button id="btnClear" style="width:80px;background-color:yellow; " onclick="drawClean();">清除</button>
    <br/>
    <button id="btnMove" style="width: 80px;background-color: #66ccff;">移动</button>
</div>
<div style="position: absolute;top: 8px;left: 212px">
    识别结果是
    <div id="numberResult"></div>
</div>
<br>

<canvas id="mainCanvas"></canvas>
<canvas id="line1" class="line"
        onclick="location.href='/static/Canvas.html'"></canvas>
<canvas id="conv1Canvas" class="showCanvas" style="width: 300px;"></canvas>
<canvas id="line2" class="line"></canvas>
<canvas id="conv2Canvas" class="showCanvas" style="width: 300px;"></canvas>
<canvas id="line3" class="line"></canvas>


</body>

</html>

